


                                  relax repository checkout r25739
                svn+ssh://bugman@svn.gna.org/svn/relax/branches/frame_order_cleanup

                              Molecular dynamics by NMR data analysis

                             Copyright (C) 2001-2006 Edward d'Auvergne
                         Copyright (C) 2006-2014 the relax development team

This is free software which you are welcome to modify and redistribute under the conditions of the
GNU General Public License (GPL).  This program, including all modules, is licensed under the GPL
and comes with absolutely no warranty.  For details type 'GPL' within the relax prompt.

Assistance in using the relax prompt and scripting interface can be accessed by typing 'help' within
the prompt.

Processor fabric:  Uni-processor.

script = 'iso_cone.py'
----------------------------------------------------------------------------------------------------
# Optimise all 3 iso cone permutations for the CaM rotor synthetic frame order data.
# These 3 solutions should mimic the rotor solution.

# Python module imports.
from numpy import array, cross, float64, transpose, zeros
from numpy.linalg import norm
import sys

# relax module imports.
from lib.geometry.coord_transform import spherical_to_cartesian
from lib.text.sectioning import section


# The real rotor parameter values.
AVE_POS_X, AVE_POS_Y, AVE_POS_Z = [ -21.269217407269576,   -3.122610661328414,   -2.400652421655998]
AVE_POS_ALPHA, AVE_POS_BETA, AVE_POS_GAMMA = [5.623469076122531, 0.435439405668396, 5.081265529106499]
AXIS_THETA = 0.9600799785953431
AXIS_PHI = 4.0322755062196229
CONE_SIGMA_MAX = 30.0 / 360.0 * 2.0 * pi

# Reconstruct the rotation axis.
AXIS = zeros(3, float64)
spherical_to_cartesian([1, AXIS_THETA, AXIS_PHI], AXIS)

# Printout.
print("Torsion angle: %s" % CONE_SIGMA_MAX)
print("Rotation axis: %s" % AXIS)

# Load the optimised rotor state for creating the iso cone data pipes.
state.load(state='frame_order_true', dir='..')

# Set up the dynamic system.
value.set(param='ave_pos_x', val=AVE_POS_X)
value.set(param='ave_pos_y', val=AVE_POS_Y)
value.set(param='ave_pos_z', val=AVE_POS_Z)
value.set(param='ave_pos_alpha', val=AVE_POS_ALPHA)
value.set(param='ave_pos_beta', val=AVE_POS_BETA)
value.set(param='ave_pos_gamma', val=AVE_POS_GAMMA)
value.set(param='axis_theta', val=AXIS_THETA)
value.set(param='axis_phi', val=AXIS_PHI)

# Set the torsion angle to the rotor opening half-angle.
value.set(param='cone_sigma_max', val=CONE_SIGMA_MAX)

# Set the cone opening angle to a very small value close to zero.
value.set(param='cone_theta', val=0.1)

# Fix the true pivot point.
frame_order.pivot([ 37.254, 0.5, 16.7465], fix=True)

# Change the model.
frame_order.select_model('iso cone')

# Loop over the 2 permutations.
pipe_name = 'iso cone'
tag = ''
for perm in [None, 'A']:
    # The original permutation.
    if perm == None:
        # Title printout.
        section(file=sys.stdout, text="Isotropic cone original permutation")

        # Create a new data base data pipe for the iso cone.
        pipe.copy(pipe_from='frame order', pipe_to='iso cone')
        pipe.switch(pipe_name='iso cone')

    # Operations for the 'A' and 'B' permutations.
    else:
        # Title printout.
        section(file=sys.stdout, text="Isotropic cone permutation %s" % perm)

        # The pipe name and tag.
        pipe_name = 'iso cone perm %s' % perm
        tag = '_perm_%s' % perm

        # Create a new data pipe.
        pipe.copy(pipe_from='frame order', pipe_to=pipe_name)
        pipe.switch(pipe_name=pipe_name)

        # Permute the axes.
        frame_order.permute_axes(permutation=perm)

    # Create a pre-optimisation PDB representation.
    frame_order.pdb_model(ave_pos=None, rep='fo_orig'+tag, dist=None, compress_type=2, force=True)

    # High precision optimisation.
    frame_order.num_int_pts(num=10000)
    minimise.execute('simplex', func_tol=1e-4)

    # Create the PDB representation.
    frame_order.pdb_model(ave_pos=None, rep='fo'+tag, dist=None, compress_type=2, force=True)

# Sanity check.
pipe.display()
----------------------------------------------------------------------------------------------------
Torsion angle: 0.523598775598
Rotation axis: [-0.515203065764379 -0.63695822150172   0.573454466447295]

relax> state.load(state='frame_order_true', dir='..', force=False)
Opening the file '../frame_order_true.bz2' for reading.

relax> value.set(val=-21.269217407269576, param='ave_pos_x', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=-3.122610661328414, param='ave_pos_y', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=-2.400652421655998, param='ave_pos_z', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=5.623469076122531, param='ave_pos_alpha', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=0.435439405668396, param='ave_pos_beta', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=5.081265529106499, param='ave_pos_gamma', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=0.9600799785953431, param='axis_theta', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=4.032275506219623, param='axis_phi', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=0.5235987755982988, param='cone_sigma_max', index=0, spin_id=None, error=False, force=True)

relax> value.set(val=0.1, param='cone_theta', index=0, spin_id=None, error=False, force=True)

relax> frame_order.pivot(pivot=[37.254, 0.5, 16.7465], order=1, fix=True)

relax> frame_order.select_model(model='iso cone')


Isotropic cone original permutation
===================================


relax> pipe.copy(pipe_from='frame order', pipe_to='iso cone', bundle_to=None)

relax> pipe.switch(pipe_name='iso cone')

relax> frame_order.pdb_model(ave_pos=None, rep='fo_orig', dist=None, dir=None, compress_type=2, size=30.0, inc=36, force=True)

Creating a PDB file containing a geometric object representing the frame order dynamics.
----------------------------------------------------------------------------------------


Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.831304810763073 -0.208562011471785 -0.515203065764379]
 [-0.208562011471785  0.742149655684222 -0.63695822150172 ]
 [ 0.515203065764379  0.63695822150172   0.573454466447295]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_orig_A.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.831304810763073 -0.208562011471785 -0.515203065764379]
 [-0.208562011471785  0.742149655684222 -0.63695822150172 ]
 [ 0.515203065764379  0.63695822150172   0.573454466447295]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_orig_B.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

relax> frame_order.num_int_pts(num=10000)

relax> minimise.execute(min_algor='simplex', line_search=None, hessian_mod=None, hessian_type=None, func_tol=0.0001, grad_tol=None, max_iter=10000000, constraints=True, scaling=True, verbosity=1)
No PCS data is present, deselecting the spin '#N-dom:1@N'.
No PCS data is present, deselecting the spin '#N-dom:1@H'.
No PCS data is present, deselecting the spin '#N-dom:2@N'.
No PCS data is present, deselecting the spin '#N-dom:2@H'.
No PCS data is present, deselecting the spin '#N-dom:3@N'.
No PCS data is present, deselecting the spin '#N-dom:3@H'.
No PCS data is present, deselecting the spin '#N-dom:4@N'.
No PCS data is present, deselecting the spin '#N-dom:4@H'.
No PCS data is present, deselecting the spin '#N-dom:5@N'.
No PCS data is present, deselecting the spin '#N-dom:5@H'.
No PCS data is present, deselecting the spin '#N-dom:6@N'.
No PCS data is present, deselecting the spin '#N-dom:6@H'.
No PCS data is present, deselecting the spin '#N-dom:7@N'.
No PCS data is present, deselecting the spin '#N-dom:7@H'.
No PCS data is present, deselecting the spin '#N-dom:8@N'.
No PCS data is present, deselecting the spin '#N-dom:8@H'.
No PCS data is present, deselecting the spin '#N-dom:9@N'.
No PCS data is present, deselecting the spin '#N-dom:9@H'.
No PCS data is present, deselecting the spin '#N-dom:10@N'.
No PCS data is present, deselecting the spin '#N-dom:10@H'.
No PCS data is present, deselecting the spin '#N-dom:11@N'.
No PCS data is present, deselecting the spin '#N-dom:11@H'.
No PCS data is present, deselecting the spin '#N-dom:12@N'.
No PCS data is present, deselecting the spin '#N-dom:12@H'.
No PCS data is present, deselecting the spin '#N-dom:13@N'.
No PCS data is present, deselecting the spin '#N-dom:13@H'.
No PCS data is present, deselecting the spin '#N-dom:14@N'.
No PCS data is present, deselecting the spin '#N-dom:14@H'.
No PCS data is present, deselecting the spin '#N-dom:15@N'.
No PCS data is present, deselecting the spin '#N-dom:15@H'.
No PCS data is present, deselecting the spin '#N-dom:16@N'.
No PCS data is present, deselecting the spin '#N-dom:16@H'.
No PCS data is present, deselecting the spin '#N-dom:17@N'.
No PCS data is present, deselecting the spin '#N-dom:17@H'.
No PCS data is present, deselecting the spin '#N-dom:18@N'.
No PCS data is present, deselecting the spin '#N-dom:18@H'.
No PCS data is present, deselecting the spin '#N-dom:19@N'.
No PCS data is present, deselecting the spin '#N-dom:19@H'.
No PCS data is present, deselecting the spin '#N-dom:20@N'.
No PCS data is present, deselecting the spin '#N-dom:20@H'.
No PCS data is present, deselecting the spin '#N-dom:21@N'.
No PCS data is present, deselecting the spin '#N-dom:21@H'.
No PCS data is present, deselecting the spin '#N-dom:22@N'.
No PCS data is present, deselecting the spin '#N-dom:22@H'.
No PCS data is present, deselecting the spin '#N-dom:23@N'.
No PCS data is present, deselecting the spin '#N-dom:23@H'.
No PCS data is present, deselecting the spin '#N-dom:24@N'.
No PCS data is present, deselecting the spin '#N-dom:24@H'.
No PCS data is present, deselecting the spin '#N-dom:25@N'.
No PCS data is present, deselecting the spin '#N-dom:25@H'.
No PCS data is present, deselecting the spin '#N-dom:26@N'.
No PCS data is present, deselecting the spin '#N-dom:26@H'.
No PCS data is present, deselecting the spin '#N-dom:27@N'.
No PCS data is present, deselecting the spin '#N-dom:27@H'.
No PCS data is present, deselecting the spin '#N-dom:28@N'.
No PCS data is present, deselecting the spin '#N-dom:28@H'.
No PCS data is present, deselecting the spin '#N-dom:29@N'.
No PCS data is present, deselecting the spin '#N-dom:29@H'.
No PCS data is present, deselecting the spin '#N-dom:30@N'.
No PCS data is present, deselecting the spin '#N-dom:30@H'.
No PCS data is present, deselecting the spin '#N-dom:31@N'.
No PCS data is present, deselecting the spin '#N-dom:31@H'.
No PCS data is present, deselecting the spin '#N-dom:32@N'.
No PCS data is present, deselecting the spin '#N-dom:32@H'.
No PCS data is present, deselecting the spin '#N-dom:33@N'.
No PCS data is present, deselecting the spin '#N-dom:33@H'.
No PCS data is present, deselecting the spin '#N-dom:34@N'.
No PCS data is present, deselecting the spin '#N-dom:34@H'.
No PCS data is present, deselecting the spin '#N-dom:35@N'.
No PCS data is present, deselecting the spin '#N-dom:35@H'.
No PCS data is present, deselecting the spin '#N-dom:36@N'.
No PCS data is present, deselecting the spin '#N-dom:36@H'.
No PCS data is present, deselecting the spin '#N-dom:37@N'.
No PCS data is present, deselecting the spin '#N-dom:37@H'.
No PCS data is present, deselecting the spin '#N-dom:38@N'.
No PCS data is present, deselecting the spin '#N-dom:38@H'.
No PCS data is present, deselecting the spin '#N-dom:39@N'.
No PCS data is present, deselecting the spin '#N-dom:39@H'.
No PCS data is present, deselecting the spin '#N-dom:40@N'.
No PCS data is present, deselecting the spin '#N-dom:40@H'.
No PCS data is present, deselecting the spin '#N-dom:41@N'.
No PCS data is present, deselecting the spin '#N-dom:41@H'.
No PCS data is present, deselecting the spin '#N-dom:42@N'.
No PCS data is present, deselecting the spin '#N-dom:42@H'.
No PCS data is present, deselecting the spin '#N-dom:43@N'.
No PCS data is present, deselecting the spin '#N-dom:44@N'.
No PCS data is present, deselecting the spin '#N-dom:44@H'.
No PCS data is present, deselecting the spin '#N-dom:45@N'.
No PCS data is present, deselecting the spin '#N-dom:45@H'.
No PCS data is present, deselecting the spin '#N-dom:46@N'.
No PCS data is present, deselecting the spin '#N-dom:46@H'.
No PCS data is present, deselecting the spin '#N-dom:47@N'.
No PCS data is present, deselecting the spin '#N-dom:47@H'.
No PCS data is present, deselecting the spin '#N-dom:48@N'.
No PCS data is present, deselecting the spin '#N-dom:48@H'.
No PCS data is present, deselecting the spin '#N-dom:49@N'.
No PCS data is present, deselecting the spin '#N-dom:49@H'.
No PCS data is present, deselecting the spin '#N-dom:50@N'.
No PCS data is present, deselecting the spin '#N-dom:50@H'.
No PCS data is present, deselecting the spin '#N-dom:51@N'.
No PCS data is present, deselecting the spin '#N-dom:51@H'.
No PCS data is present, deselecting the spin '#N-dom:52@N'.
No PCS data is present, deselecting the spin '#N-dom:52@H'.
No PCS data is present, deselecting the spin '#N-dom:53@N'.
No PCS data is present, deselecting the spin '#N-dom:53@H'.
No PCS data is present, deselecting the spin '#N-dom:54@N'.
No PCS data is present, deselecting the spin '#N-dom:54@H'.
No PCS data is present, deselecting the spin '#N-dom:55@N'.
No PCS data is present, deselecting the spin '#N-dom:55@H'.
No PCS data is present, deselecting the spin '#N-dom:56@N'.
No PCS data is present, deselecting the spin '#N-dom:56@H'.
No PCS data is present, deselecting the spin '#N-dom:57@N'.
No PCS data is present, deselecting the spin '#N-dom:57@H'.
No PCS data is present, deselecting the spin '#N-dom:58@N'.
No PCS data is present, deselecting the spin '#N-dom:58@H'.
No PCS data is present, deselecting the spin '#N-dom:59@N'.
No PCS data is present, deselecting the spin '#N-dom:59@H'.
No PCS data is present, deselecting the spin '#N-dom:60@N'.
No PCS data is present, deselecting the spin '#N-dom:60@H'.
No PCS data is present, deselecting the spin '#N-dom:61@N'.
No PCS data is present, deselecting the spin '#N-dom:61@H'.
No PCS data is present, deselecting the spin '#N-dom:62@N'.
No PCS data is present, deselecting the spin '#N-dom:62@H'.
No PCS data is present, deselecting the spin '#N-dom:63@N'.
No PCS data is present, deselecting the spin '#N-dom:63@H'.
No PCS data is present, deselecting the spin '#N-dom:64@N'.
No PCS data is present, deselecting the spin '#N-dom:64@H'.
No PCS data is present, deselecting the spin '#N-dom:65@N'.
No PCS data is present, deselecting the spin '#N-dom:65@H'.
No PCS data is present, deselecting the spin '#N-dom:66@N'.
No PCS data is present, deselecting the spin '#N-dom:67@N'.
No PCS data is present, deselecting the spin '#N-dom:67@H'.
No PCS data is present, deselecting the spin '#N-dom:68@N'.
No PCS data is present, deselecting the spin '#N-dom:68@H'.
No PCS data is present, deselecting the spin '#N-dom:69@N'.
No PCS data is present, deselecting the spin '#N-dom:69@H'.
No PCS data is present, deselecting the spin '#N-dom:70@N'.
No PCS data is present, deselecting the spin '#N-dom:70@H'.
No PCS data is present, deselecting the spin '#N-dom:71@N'.
No PCS data is present, deselecting the spin '#N-dom:71@H'.
No PCS data is present, deselecting the spin '#N-dom:72@N'.
No PCS data is present, deselecting the spin '#N-dom:72@H'.
No PCS data is present, deselecting the spin '#N-dom:73@N'.
No PCS data is present, deselecting the spin '#N-dom:73@H'.
No PCS data is present, deselecting the spin '#N-dom:74@N'.
No PCS data is present, deselecting the spin '#N-dom:74@H'.
No PCS data is present, deselecting the spin '#N-dom:75@N'.
No PCS data is present, deselecting the spin '#N-dom:75@H'.
No PCS data is present, deselecting the spin '#N-dom:76@N'.
No PCS data is present, deselecting the spin '#N-dom:76@H'.

The average domain rotation centroid, taken as the CoM of the atoms defined as the moving domain, is:
    [48.105993133919419, -9.2564563045173553, 30.742194898701001]
Numerical integration:  Quasi-random Sobol' sequence.
Number of integration points:  10000
Base data: ['RDCs', 'PCSs']



Logarithmic barrier function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
k: 0        xk: [   -21.26921741,    -3.122610661,    -2.400652422,     5.623469076,    0.4354394057,     5.081265529,    0.9600799786,     4.032275506,             0.1,    0.5235987756]    fk: 5.16841689145       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.26921741,    -3.122610661,    -2.520685043,     5.623469076,    0.4354394057,     5.081265529,    0.9600799786,     4.032275506,             0.1,    0.5235987756]    fk: 4.3584438624        
	k: 100      xk: [   -21.11300878,    -3.130380878,    -2.801490566,     5.620498558,    0.4345036492,     5.081664541,    0.9196146447,     4.058554882,   0.08995154561,    0.5147112281]    fk: 1.98247363324       
	k: 200      xk: [   -21.05164674,    -3.428219801,    -2.943848261,     5.623399705,     0.436036561,     5.080877496,    0.9416355366,     4.061881373,   0.07214174568,    0.5214258642]    fk: 1.1358555803        
	k: 300      xk: [   -21.00005055,    -3.545687418,     -2.98357576,     5.622044054,    0.4354466116,     5.081776568,    0.9354677605,     4.052567747,    0.0719550482,    0.5195395891]    fk: 1.03728002834       
	k: 400      xk: [   -21.01472635,    -3.616814601,    -3.011516917,     5.621526935,    0.4348365241,     5.081821111,    0.9282166997,     4.049863241,   0.07162330484,    0.5197275908]    fk: 0.996449429369      

	Parameter values: [-21.010528724530467, -3.6173035504264028, -3.0117750346324099, 5.6215396918101401, 0.43483462720279081, 5.0818073835175168, 0.92814169214085673, 4.0500620545840951, 0.071619040522488756, 0.51963412066088654]
	Function value:   0.99621136552147471
	Iterations:       435
	Function calls:   665
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 1        xk: [   -21.01052872,     -3.61730355,    -3.011775035,     5.621539692,    0.4348346272,     5.081807384,    0.9281416921,     4.050062055,   0.07161904052,    0.5196341207]    fk: 0.996650909536      
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.01052872,     -3.61730355,    -3.011775035,     5.621539692,    0.4348346272,     5.081807384,    0.9281416921,     4.050062055,   0.07161904052,    0.5196341207]    fk: 0.996568561071      
	k: 100      xk: [   -21.00508229,     -3.63304958,    -3.024102015,     5.621728383,    0.4349367797,     5.081647144,    0.9291675662,     4.050430179,   0.07163960983,    0.5196646109]    fk: 0.99589594714       
	k: 200      xk: [   -21.00980559,     -3.62724858,    -3.021215207,     5.621593648,    0.4349116572,     5.081596902,    0.9284710294,     4.048600463,   0.07162283531,    0.5194066821]    fk: 0.993538467149      

	Parameter values: [-21.012437873709644, -3.62236397640631, -3.0169476518745113, 5.6215049128098844, 0.43487792926677432, 5.0816133370228513, 0.92798403769657389, 4.0478074199717318, 0.07161876909631687, 0.51929869066706003]
	Function value:   0.99321007989666932
	Iterations:       237
	Function calls:   387
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 2        xk: [   -21.01243787,    -3.622363976,    -3.016947652,     5.621504913,    0.4348779293,     5.081613337,    0.9279840377,      4.04780742,    0.0716187691,    0.5192986907]    fk: 0.993270036708      
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.01243787,    -3.622363976,    -3.016947652,     5.621504913,    0.4348779293,     5.081613337,    0.9279840377,      4.04780742,    0.0716187691,    0.5192986907]    fk: 0.9932136518        
	k: 100      xk: [   -21.01243787,    -3.622363976,    -3.016947652,     5.621504913,    0.4348779293,     5.081613337,    0.9279840377,      4.04780742,    0.0716187691,    0.5192986907]    fk: 0.9932136518        
	k: 200      xk: [   -21.02266198,    -3.612578178,    -3.008839958,     5.621736749,    0.4348487508,      5.08146305,    0.9293896573,     4.046714702,   0.07161931812,    0.5195560513]    fk: 0.991416237502      

	Parameter values: [-21.025139417858956, -3.6113041419460212, -3.0063774476842875, 5.6217499805788842, 0.43484987491099114, 5.0814527909746268, 0.92979717387663974, 4.0464026627308929, 0.071618791892904071, 0.5196231462166423]
	Function value:   0.99132882243988352
	Iterations:       212
	Function calls:   352
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 3        xk: [   -21.02513942,    -3.611304142,    -3.006377448,     5.621749981,    0.4348498749,     5.081452791,    0.9297971739,     4.046402663,   0.07161879189,    0.5196231462]    fk: 0.991396517043      
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.02513942,    -3.611304142,    -3.006377448,     5.621749981,    0.4348498749,     5.081452791,    0.9297971739,     4.046402663,   0.07161879189,    0.5196231462]    fk: 0.991328858159      
	k: 100      xk: [   -21.02513942,    -3.611304142,    -3.006377448,     5.621749981,    0.4348498749,     5.081452791,    0.9297971739,     4.046402663,   0.07161879189,    0.5196231462]    fk: 0.991328858159      

	Parameter values: [-21.020409830476211, -3.6088151058364906, -3.0072615760625423, 5.6217707163661661, 0.43481905007362864, 5.0814564395155166, 0.9296971496803903, 4.0460770275427738, 0.07161814121071032, 0.51956741819714969]
	Function value:   0.99111574678827263
	Iterations:       170
	Function calls:   306
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 4        xk: [   -21.02040983,    -3.608815106,    -3.007261576,     5.621770716,    0.4348190501,      5.08145644,    0.9296971497,     4.046077028,   0.07161814121,    0.5195674182]    fk: 0.991172803571      
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.02040983,    -3.608815106,    -3.007261576,     5.621770716,    0.4348190501,      5.08145644,    0.9296971497,     4.046077028,   0.07161814121,    0.5195674182]    fk: 0.991115747145      
	k: 100      xk: [   -21.02040983,    -3.608815106,    -3.007261576,     5.621770716,    0.4348190501,      5.08145644,    0.9296971497,     4.046077028,   0.07161814121,    0.5195674182]    fk: 0.991115747145      

	Parameter values: [-21.019044503110209, -3.6063318392607631, -3.0051420862990303, 5.62174490008824, 0.43480808756788891, 5.0814516704880841, 0.92991576176604263, 4.0453780714414975, 0.07161958116057035, 0.51968985560732661]
	Function value:   0.99101044172385111
	Iterations:       165
	Function calls:   285
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 5        xk: [    -21.0190445,    -3.606331839,    -3.005142086,       5.6217449,    0.4348080876,      5.08145167,    0.9299157618,     4.045378071,   0.07161958116,    0.5196898556]    fk: 0.991064136403      
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [    -21.0190445,    -3.606331839,    -3.005142086,       5.6217449,    0.4348080876,      5.08145167,    0.9299157618,     4.045378071,   0.07161958116,    0.5196898556]    fk: 0.991010441727      
	k: 100      xk: [    -21.0190445,    -3.606331839,    -3.005142086,       5.6217449,    0.4348080876,      5.08145167,    0.9299157618,     4.045378071,   0.07161958116,    0.5196898556]    fk: 0.991010441727      

	Parameter values: [-21.020205168808985, -3.6039490142641792, -3.0032872294165536, 5.6217139195096246, 0.4347996429275951, 5.0814572053547682, 0.92970498589404316, 4.0451483553565266, 0.071618882464140249, 0.51968034017594156]
	Function value:   0.99098999548144784
	Iterations:       169
	Function calls:   293
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None


Parameter values: [-21.020205168808985, -3.6039490142641792, -3.0032872294165536, 5.6217139195096246, 0.4347996429275951, 5.0814572053547682, 0.92970498589404316, 4.0451483553565266, 0.071618882464140249, 0.51968034017594156]
Function value:   0.99098999548148392
Iterations:       1388
Function calls:   2288
Gradient calls:   0
Hessian calls:    0
Warning:          None

Storing the optimisation results, no optimised values currently exist.

relax> frame_order.pdb_model(ave_pos=None, rep='fo', dist=None, dir=None, compress_type=2, size=30.0, inc=36, force=True)

Creating a PDB file containing a geometric object representing the frame order dynamics.
----------------------------------------------------------------------------------------


Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.846085440996108 -0.195379422316049 -0.495949904597097]
 [-0.195379422316049  0.751985004462199 -0.629559714720879]
 [ 0.495949904597097  0.629559714720879  0.598070445458306]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_A.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.846085440996108 -0.195379422316049 -0.495949904597097]
 [-0.195379422316049  0.751985004462199 -0.629559714720879]
 [ 0.495949904597097  0.629559714720879  0.598070445458306]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_B.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END


Isotropic cone permutation A
============================


relax> pipe.copy(pipe_from='frame order', pipe_to='iso cone perm A', bundle_to=None)

relax> pipe.switch(pipe_name='iso cone perm A')

relax> frame_order.permute_axes(permutation='A')

Original parameters:
cone_theta                   0.1000000000
cone_sigma_max               0.5235987756
axis_theta                   0.9600799786
axis_phi                     4.0322755062
cone axis           
[-0.515203065764379 -0.63695822150172   0.573454466447295]
full axis system    
[[ 0.857068142580848 -0.                -0.515203065764379]
 [-0.382890008597602  0.669088533288005 -0.63695822150172 ]
 [ 0.344716463617772  0.743182706084113  0.573454466447295]]

Permutation 'A':
Starting condition   x <= y <= z         
Cone angle permutation [0, 2, 1]           
Axes permutation     [2, 1, 0]           

Permuted parameters:
cone_theta                   0.3117993878
cone_sigma_max               0.1000000000
axis_theta                   0.7329816724
axis_phi                     1.5707963268
cone axis           
[-0.                 0.669088533288005  0.743182706084113]

relax> frame_order.pdb_model(ave_pos=None, rep='fo_orig_perm_A', dist=None, dir=None, compress_type=2, size=30.0, inc=36, force=True)

Creating a PDB file containing a geometric object representing the frame order dynamics.
----------------------------------------------------------------------------------------


Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[  1.000000000000000e+00  -1.572552384798878e-17   4.096985653186766e-17]
 [ -1.572552384798878e-17   7.431827060841134e-01   6.690885332880054e-01]
 [ -4.096985653186766e-17  -6.690885332880054e-01   7.431827060841134e-01]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_orig_perm_A_A.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[  1.000000000000000e+00  -1.572552384798878e-17   4.096985653186766e-17]
 [ -1.572552384798878e-17   7.431827060841134e-01   6.690885332880054e-01]
 [ -4.096985653186766e-17  -6.690885332880054e-01   7.431827060841134e-01]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_orig_perm_A_B.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

relax> frame_order.num_int_pts(num=10000)

relax> minimise.execute(min_algor='simplex', line_search=None, hessian_mod=None, hessian_type=None, func_tol=0.0001, grad_tol=None, max_iter=10000000, constraints=True, scaling=True, verbosity=1)
No PCS data is present, deselecting the spin '#N-dom:1@N'.
No PCS data is present, deselecting the spin '#N-dom:1@H'.
No PCS data is present, deselecting the spin '#N-dom:2@N'.
No PCS data is present, deselecting the spin '#N-dom:2@H'.
No PCS data is present, deselecting the spin '#N-dom:3@N'.
No PCS data is present, deselecting the spin '#N-dom:3@H'.
No PCS data is present, deselecting the spin '#N-dom:4@N'.
No PCS data is present, deselecting the spin '#N-dom:4@H'.
No PCS data is present, deselecting the spin '#N-dom:5@N'.
No PCS data is present, deselecting the spin '#N-dom:5@H'.
No PCS data is present, deselecting the spin '#N-dom:6@N'.
No PCS data is present, deselecting the spin '#N-dom:6@H'.
No PCS data is present, deselecting the spin '#N-dom:7@N'.
No PCS data is present, deselecting the spin '#N-dom:7@H'.
No PCS data is present, deselecting the spin '#N-dom:8@N'.
No PCS data is present, deselecting the spin '#N-dom:8@H'.
No PCS data is present, deselecting the spin '#N-dom:9@N'.
No PCS data is present, deselecting the spin '#N-dom:9@H'.
No PCS data is present, deselecting the spin '#N-dom:10@N'.
No PCS data is present, deselecting the spin '#N-dom:10@H'.
No PCS data is present, deselecting the spin '#N-dom:11@N'.
No PCS data is present, deselecting the spin '#N-dom:11@H'.
No PCS data is present, deselecting the spin '#N-dom:12@N'.
No PCS data is present, deselecting the spin '#N-dom:12@H'.
No PCS data is present, deselecting the spin '#N-dom:13@N'.
No PCS data is present, deselecting the spin '#N-dom:13@H'.
No PCS data is present, deselecting the spin '#N-dom:14@N'.
No PCS data is present, deselecting the spin '#N-dom:14@H'.
No PCS data is present, deselecting the spin '#N-dom:15@N'.
No PCS data is present, deselecting the spin '#N-dom:15@H'.
No PCS data is present, deselecting the spin '#N-dom:16@N'.
No PCS data is present, deselecting the spin '#N-dom:16@H'.
No PCS data is present, deselecting the spin '#N-dom:17@N'.
No PCS data is present, deselecting the spin '#N-dom:17@H'.
No PCS data is present, deselecting the spin '#N-dom:18@N'.
No PCS data is present, deselecting the spin '#N-dom:18@H'.
No PCS data is present, deselecting the spin '#N-dom:19@N'.
No PCS data is present, deselecting the spin '#N-dom:19@H'.
No PCS data is present, deselecting the spin '#N-dom:20@N'.
No PCS data is present, deselecting the spin '#N-dom:20@H'.
No PCS data is present, deselecting the spin '#N-dom:21@N'.
No PCS data is present, deselecting the spin '#N-dom:21@H'.
No PCS data is present, deselecting the spin '#N-dom:22@N'.
No PCS data is present, deselecting the spin '#N-dom:22@H'.
No PCS data is present, deselecting the spin '#N-dom:23@N'.
No PCS data is present, deselecting the spin '#N-dom:23@H'.
No PCS data is present, deselecting the spin '#N-dom:24@N'.
No PCS data is present, deselecting the spin '#N-dom:24@H'.
No PCS data is present, deselecting the spin '#N-dom:25@N'.
No PCS data is present, deselecting the spin '#N-dom:25@H'.
No PCS data is present, deselecting the spin '#N-dom:26@N'.
No PCS data is present, deselecting the spin '#N-dom:26@H'.
No PCS data is present, deselecting the spin '#N-dom:27@N'.
No PCS data is present, deselecting the spin '#N-dom:27@H'.
No PCS data is present, deselecting the spin '#N-dom:28@N'.
No PCS data is present, deselecting the spin '#N-dom:28@H'.
No PCS data is present, deselecting the spin '#N-dom:29@N'.
No PCS data is present, deselecting the spin '#N-dom:29@H'.
No PCS data is present, deselecting the spin '#N-dom:30@N'.
No PCS data is present, deselecting the spin '#N-dom:30@H'.
No PCS data is present, deselecting the spin '#N-dom:31@N'.
No PCS data is present, deselecting the spin '#N-dom:31@H'.
No PCS data is present, deselecting the spin '#N-dom:32@N'.
No PCS data is present, deselecting the spin '#N-dom:32@H'.
No PCS data is present, deselecting the spin '#N-dom:33@N'.
No PCS data is present, deselecting the spin '#N-dom:33@H'.
No PCS data is present, deselecting the spin '#N-dom:34@N'.
No PCS data is present, deselecting the spin '#N-dom:34@H'.
No PCS data is present, deselecting the spin '#N-dom:35@N'.
No PCS data is present, deselecting the spin '#N-dom:35@H'.
No PCS data is present, deselecting the spin '#N-dom:36@N'.
No PCS data is present, deselecting the spin '#N-dom:36@H'.
No PCS data is present, deselecting the spin '#N-dom:37@N'.
No PCS data is present, deselecting the spin '#N-dom:37@H'.
No PCS data is present, deselecting the spin '#N-dom:38@N'.
No PCS data is present, deselecting the spin '#N-dom:38@H'.
No PCS data is present, deselecting the spin '#N-dom:39@N'.
No PCS data is present, deselecting the spin '#N-dom:39@H'.
No PCS data is present, deselecting the spin '#N-dom:40@N'.
No PCS data is present, deselecting the spin '#N-dom:40@H'.
No PCS data is present, deselecting the spin '#N-dom:41@N'.
No PCS data is present, deselecting the spin '#N-dom:41@H'.
No PCS data is present, deselecting the spin '#N-dom:42@N'.
No PCS data is present, deselecting the spin '#N-dom:42@H'.
No PCS data is present, deselecting the spin '#N-dom:43@N'.
No PCS data is present, deselecting the spin '#N-dom:44@N'.
No PCS data is present, deselecting the spin '#N-dom:44@H'.
No PCS data is present, deselecting the spin '#N-dom:45@N'.
No PCS data is present, deselecting the spin '#N-dom:45@H'.
No PCS data is present, deselecting the spin '#N-dom:46@N'.
No PCS data is present, deselecting the spin '#N-dom:46@H'.
No PCS data is present, deselecting the spin '#N-dom:47@N'.
No PCS data is present, deselecting the spin '#N-dom:47@H'.
No PCS data is present, deselecting the spin '#N-dom:48@N'.
No PCS data is present, deselecting the spin '#N-dom:48@H'.
No PCS data is present, deselecting the spin '#N-dom:49@N'.
No PCS data is present, deselecting the spin '#N-dom:49@H'.
No PCS data is present, deselecting the spin '#N-dom:50@N'.
No PCS data is present, deselecting the spin '#N-dom:50@H'.
No PCS data is present, deselecting the spin '#N-dom:51@N'.
No PCS data is present, deselecting the spin '#N-dom:51@H'.
No PCS data is present, deselecting the spin '#N-dom:52@N'.
No PCS data is present, deselecting the spin '#N-dom:52@H'.
No PCS data is present, deselecting the spin '#N-dom:53@N'.
No PCS data is present, deselecting the spin '#N-dom:53@H'.
No PCS data is present, deselecting the spin '#N-dom:54@N'.
No PCS data is present, deselecting the spin '#N-dom:54@H'.
No PCS data is present, deselecting the spin '#N-dom:55@N'.
No PCS data is present, deselecting the spin '#N-dom:55@H'.
No PCS data is present, deselecting the spin '#N-dom:56@N'.
No PCS data is present, deselecting the spin '#N-dom:56@H'.
No PCS data is present, deselecting the spin '#N-dom:57@N'.
No PCS data is present, deselecting the spin '#N-dom:57@H'.
No PCS data is present, deselecting the spin '#N-dom:58@N'.
No PCS data is present, deselecting the spin '#N-dom:58@H'.
No PCS data is present, deselecting the spin '#N-dom:59@N'.
No PCS data is present, deselecting the spin '#N-dom:59@H'.
No PCS data is present, deselecting the spin '#N-dom:60@N'.
No PCS data is present, deselecting the spin '#N-dom:60@H'.
No PCS data is present, deselecting the spin '#N-dom:61@N'.
No PCS data is present, deselecting the spin '#N-dom:61@H'.
No PCS data is present, deselecting the spin '#N-dom:62@N'.
No PCS data is present, deselecting the spin '#N-dom:62@H'.
No PCS data is present, deselecting the spin '#N-dom:63@N'.
No PCS data is present, deselecting the spin '#N-dom:63@H'.
No PCS data is present, deselecting the spin '#N-dom:64@N'.
No PCS data is present, deselecting the spin '#N-dom:64@H'.
No PCS data is present, deselecting the spin '#N-dom:65@N'.
No PCS data is present, deselecting the spin '#N-dom:65@H'.
No PCS data is present, deselecting the spin '#N-dom:66@N'.
No PCS data is present, deselecting the spin '#N-dom:67@N'.
No PCS data is present, deselecting the spin '#N-dom:67@H'.
No PCS data is present, deselecting the spin '#N-dom:68@N'.
No PCS data is present, deselecting the spin '#N-dom:68@H'.
No PCS data is present, deselecting the spin '#N-dom:69@N'.
No PCS data is present, deselecting the spin '#N-dom:69@H'.
No PCS data is present, deselecting the spin '#N-dom:70@N'.
No PCS data is present, deselecting the spin '#N-dom:70@H'.
No PCS data is present, deselecting the spin '#N-dom:71@N'.
No PCS data is present, deselecting the spin '#N-dom:71@H'.
No PCS data is present, deselecting the spin '#N-dom:72@N'.
No PCS data is present, deselecting the spin '#N-dom:72@H'.
No PCS data is present, deselecting the spin '#N-dom:73@N'.
No PCS data is present, deselecting the spin '#N-dom:73@H'.
No PCS data is present, deselecting the spin '#N-dom:74@N'.
No PCS data is present, deselecting the spin '#N-dom:74@H'.
No PCS data is present, deselecting the spin '#N-dom:75@N'.
No PCS data is present, deselecting the spin '#N-dom:75@H'.
No PCS data is present, deselecting the spin '#N-dom:76@N'.
No PCS data is present, deselecting the spin '#N-dom:76@H'.

The average domain rotation centroid, taken as the CoM of the atoms defined as the moving domain, is:
    [48.105993133919419, -9.2564563045173553, 30.742194898701001]
Numerical integration:  Quasi-random Sobol' sequence.
Number of integration points:  10000
Base data: ['RDCs', 'PCSs']



Logarithmic barrier function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
k: 0        xk: [   -21.26921741,    -3.122610661,    -2.400652422,     5.623469076,    0.4354394057,     5.081265529,    0.7329816724,     1.570796327,    0.3117993878,             0.1]    fk: 306.008924098       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.26921741,    -3.122610661,    -2.400652422,     5.623469076,    0.4354394057,     5.081265529,    0.7329816724,     1.570796327,    0.3117993878,             0.1]    fk: 306.008564394       
	k: 100      xk: [   -22.40370407,    -3.907492517,    -2.601047026,     5.614708045,     0.435299112,      5.06727005,    0.9531223958,   -0.0031972703,    0.2757395983,    0.1260364103]    fk: 193.325626996       
	k: 200      xk: [   -21.78788776,    -3.561494393,    -2.721434104,     5.622965443,    0.4371740607,      5.06035435,    0.9270558802,   0.03837838449,    0.3098194592,    0.1245525503]    fk: 180.642623301       
	k: 300      xk: [   -21.40977526,    -3.539776963,    -2.774975192,     5.625697424,    0.4347961658,     5.058888892,    0.9413181486,  -0.01573278533,    0.3095657247,    0.1242542831]    fk: 179.661583841       
	k: 400      xk: [   -21.46129287,    -3.527894264,    -2.783967545,     5.624832339,    0.4354443925,     5.058911636,    0.9443806312,  -0.03280496267,    0.3097480377,    0.1242540246]    fk: 179.575297013       

	Parameter values: [-21.454952377134966, -3.5233664039546535, -2.7854945972497953, 5.6248539308956893, 0.43568978444242906, 5.0588457745852917, 0.94329524227736272, -0.026912361129132291, 0.30980298544505608, 0.12425249634605577]
	Function value:   179.56942356266339
	Iterations:       500
	Function calls:   759
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 1        xk: [   -21.45495238,    -3.523366404,    -2.785494597,     5.624853931,    0.4356897844,     5.058845775,    0.9432952423,  -0.02691236113,    0.3098029854,    0.1242524963]    fk: 179.569922061       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.45495238,    -3.523366404,    -2.785494597,     5.624853931,    0.4356897844,     5.058845775,    0.9904600044,  -0.02691236113,    0.3098029854,    0.1242524963]    fk: 178.275724947       
	k: 100      xk: [   -21.60843008,    -3.182289182,    -2.854028229,      5.62461226,    0.4341752771,     5.060706797,     1.065704331,  -0.02707461245,    0.3091237577,    0.1242571953]    fk: 176.480300673       
	k: 200      xk: [   -21.65012541,    -2.835520438,    -2.619987584,     5.626209116,     0.433579451,     5.059864293,     1.061545073,  -0.03032457473,    0.3094011253,    0.1243595937]    fk: 176.232829962       
	k: 300      xk: [   -21.69697574,    -2.766520085,    -2.578429895,     5.626216496,    0.4337920387,     5.060058859,     1.063794508,  -0.03108491031,    0.3086221155,    0.1242533781]    fk: 176.172619052       
	k: 400      xk: [   -21.72434306,    -2.758374514,     -2.56203042,     5.626448896,     0.433717011,     5.059838328,     1.061811138,   -0.0311100779,      0.30833642,    0.1242525154]    fk: 176.167422639       

	Parameter values: [-21.719061113530138, -2.7612408915879927, -2.5650324557203565, 5.6264188030096012, 0.43372448066814007, 5.0598675968340476, 1.0616680024595233, -0.031101392592104891, 0.30835437173926128, 0.1242525297788033]
	Function value:   176.16728181347852
	Iterations:       423
	Function calls:   661
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 2        xk: [   -21.71906111,    -2.761240892,    -2.565032456,     5.626418803,    0.4337244807,     5.059867597,     1.061668002,  -0.03110139259,    0.3083543717,    0.1242525298]    fk: 176.16729037        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.71906111,    -2.761240892,    -2.565032456,     5.626418803,    0.4337244807,     5.059867597,     1.061668002,  -0.03265646222,    0.3083543717,    0.1242525298]    fk: 176.161545225       
	k: 100      xk: [   -21.80490456,    -3.213516217,    -2.922602007,     5.629421408,    0.4357285595,     5.059430365,     1.105174011,  -0.03354700688,    0.3137945538,    0.0843044525]    fk: 160.163526614       
	k: 200      xk: [   -21.61541767,    -3.491593587,     -2.99738453,     5.629014897,    0.4332094513,     5.060381754,     1.067686752,  -0.03285492065,    0.3108545449,   0.08252880587]    fk: 158.483864376       
	k: 300      xk: [   -21.52621646,    -3.474212879,    -3.009735686,     5.628603419,    0.4336722443,     5.060344139,     1.066467077,  -0.03275389366,    0.3097683388,   0.08245309426]    fk: 158.394250513       
	k: 400      xk: [   -21.59053966,    -3.372833637,    -2.931208043,     5.628667938,    0.4335305012,     5.060253376,     1.057986254,  -0.03328649621,    0.3075804209,   0.08247081286]    fk: 158.330630044       

	Parameter values: [-21.578968018380138, -3.3718328626572425, -2.9080969134335977, 5.6288798808430727, 0.43340014332382648, 5.0599850188456195, 1.0597242159523612, -0.033341130374678993, 0.30873430133998558, 0.08248943715474677]
	Function value:   158.30500980273575
	Iterations:       500
	Function calls:   733
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 3        xk: [   -21.57896802,    -3.371832863,    -2.908096913,     5.628879881,    0.4334001433,     5.059985019,     1.059724216,  -0.03334113037,    0.3087343013,   0.08248943715]    fk: 158.305163183       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.57896802,    -3.371832863,    -2.908096913,     5.628879881,    0.4334001433,     5.059985019,     1.059724216,  -0.03500818689,    0.3087343013,   0.08248943715]    fk: 158.295235454       
	k: 100      xk: [   -21.53461548,    -3.176281941,     -3.23339975,     5.628461596,    0.4331125411,     5.059583165,     1.059764318,  -0.03919719407,     0.324979784,   0.05374566837]    fk: 152.287807333       
	k: 200      xk: [    -21.5672033,    -3.289346018,    -3.045514309,     5.629028938,    0.4330485497,     5.059314796,     1.062852498,  -0.04040741713,    0.3248550556,   0.05371187265]    fk: 151.549089547       
	k: 300      xk: [   -21.52671242,    -3.007286029,     -2.92004155,     5.630668074,    0.4322556334,     5.058657435,     1.070586764,   -0.0454600221,    0.3245764343,   0.05372713114]    fk: 151.37965292        
	k: 400      xk: [   -21.61241686,     -2.86207533,    -2.781108338,     5.629664533,    0.4325437747,     5.059086283,     1.070902066,  -0.04829764442,    0.3245576205,   0.05385807202]    fk: 151.276792721       

	Parameter values: [-21.646387724055529, -2.8277096449143642, -2.7778168336587798, 5.629619799539082, 0.43268352284315004, 5.059095535600088, 1.068844077433714, -0.048799985242762578, 0.32438717770194359, 0.053788966605500893]
	Function value:   151.26700406452545
	Iterations:       500
	Function calls:   755
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 4        xk: [   -21.64638772,    -2.827709645,    -2.777816834,       5.6296198,    0.4326835228,     5.059095536,     1.068844077,  -0.04879998524,    0.3243871777,   0.05378896661]    fk: 151.267186763       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.64638772,    -2.827709645,    -2.777816834,       5.6296198,    0.4326835228,     5.059095536,     1.068844077,   -0.0512399845,    0.3243871777,   0.05378896661]    fk: 151.252665469       
	k: 100      xk: [   -21.50401174,    -2.958197319,    -2.817355032,     5.627354928,    0.4323250685,     5.061239095,     1.061802424,  -0.04971183469,    0.3121792308,   0.05369938466]    fk: 150.086571602       
	k: 200      xk: [   -21.53246462,    -2.925576346,    -2.807715929,     5.626833533,    0.4322050195,     5.061992751,     1.064655139,  -0.05010345315,    0.3122091408,   0.05368934603]    fk: 150.061854522       
	k: 300      xk: [   -21.50439528,    -2.910462658,    -2.816634287,     5.626891613,    0.4323013635,     5.061945979,      1.06697682,  -0.05052409433,    0.3120795972,   0.05368940727]    fk: 150.055541221       

	Parameter values: [-21.515172912606893, -2.9064387164055905, -2.8162835504751493, 5.6269178056127576, 0.43234544805236985, 5.0618985225934061, 1.0665154428996484, -0.050592784489659544, 0.31219008157304906, 0.053689333351814958]
	Function value:   150.05462246302736
	Iterations:       363
	Function calls:   567
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 5        xk: [   -21.51517291,    -2.906438716,     -2.81628355,     5.626917806,    0.4323454481,     5.061898523,     1.066515443,  -0.05059278449,    0.3121900816,   0.05368933335]    fk: 150.054688302       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.51517291,    -2.906438716,     -2.81628355,     5.626917806,    0.4323454481,     5.061898523,     1.066515443,  -0.05312242371,    0.3121900816,   0.05368933335]    fk: 150.04833254        
	k: 100      xk: [   -21.51517291,    -2.906438716,     -2.81628355,     5.626917806,    0.4323454481,     5.061898523,     1.066515443,  -0.05312242371,    0.3121900816,   0.05368933335]    fk: 150.04833254        
	k: 200      xk: [   -21.52339828,    -2.905905656,    -2.810822095,     5.626955535,    0.4322254787,     5.061965461,     1.069390942,  -0.06463688928,    0.3124487046,   0.05369021889]    fk: 150.036012729       

	Parameter values: [-21.524192629410997, -2.8978697971953302, -2.8073094853289575, 5.6269637130442618, 0.43217477412380534, 5.0620164743342961, 1.0706053861053459, -0.0645692749970814, 0.31226386687168184, 0.053689457932418222]
	Function value:   150.03503341794575
	Iterations:       284
	Function calls:   461
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 6        xk: [   -21.52419263,    -2.897869797,    -2.807309485,     5.626963713,    0.4321747741,     5.062016474,     1.070605386,    -0.064569275,    0.3122638669,   0.05368945793]    fk: 150.035103186       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   -21.52419263,    -2.897869797,    -2.807309485,     5.626963713,    0.4321747741,     5.062016474,     1.070605386,    -0.064569275,    0.3122638669,   0.05368945793]    fk: 150.035033418       
	k: 100      xk: [   -21.52419263,    -2.897869797,    -2.807309485,     5.626963713,    0.4321747741,     5.062016474,     1.070605386,    -0.064569275,    0.3122638669,   0.05368945793]    fk: 150.035033418       

	Parameter values: [-21.524766759193291, -2.9003919667599689, -2.8067776759438017, 5.6269665985031985, 0.43216365787857824, 5.0620254177975141, 1.070629275031094, -0.064749564086208466, 0.31226942059249607, 0.053689418369571688]
	Function value:   150.03498305517866
	Iterations:       140
	Function calls:   269
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None


Parameter values: [-21.524766759193291, -2.9003919667599689, -2.8067776759438017, 5.6269665985031985, 0.43216365787857824, 5.0620254177975141, 1.070629275031094, -0.064749564086208466, 0.31226942059249607, 0.053689418369571688]
Function value:   150.03498305517866
Iterations:       2710
Function calls:   4205
Gradient calls:   0
Hessian calls:    0
Warning:          None

Storing the optimisation results, no optimised values currently exist.

relax> frame_order.pdb_model(ave_pos=None, rep='fo_perm_A', dist=None, dir=None, compress_type=2, size=30.0, inc=36, force=True)

Creating a PDB file containing a geometric object representing the frame order dynamics.
----------------------------------------------------------------------------------------


Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.481750983105458  0.033603371842738  0.875663636151304]
 [ 0.033603371842738  0.997821150523415 -0.056778208574477]
 [-0.875663636151304  0.056778208574477  0.479572133628873]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_perm_A_A.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

Creating the Representation A.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rotation matrix:
[[ 0.481750983105458  0.033603371842738  0.875663636151304]
 [ 0.033603371842738  0.997821150523415 -0.056778208574477]
 [-0.875663636151304  0.056778208574477  0.479572133628873]]

Generating the cone outer edge.

Generating the cone cap.
    Creating the uniform vector distribution.
Opening the file 'fo_perm_A_B.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
ATOM, HETATM, TER
CONECT

MASTER
END

relax> pipe.display()
# Data pipe name     Data pipe type    Bundle    Current    
'frame order'        frame order       None                 
'iso cone'           frame order       None                 
'iso cone perm A'    frame order       None      *          

